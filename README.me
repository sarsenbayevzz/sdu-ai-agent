# SDU Academic AI Agent

Unified intelligent academic assistant for Suleyman Demirel University.

**INF 395 Capstone — Phase 1 + Phase 2**

---

## Group Members

| Name | Role |
|------|------|
| Aziz | AI Integration / Backend Developer |
| Kamiliya | Team Lead / Frontend / UI Designer |
| Azhar | AI Integration / Full-Stack Developer |

---

## Project Structure

```
sdu-ai-agent/
├── frontend/
│   └── index.html          # Open directly in browser (no build needed)
└── backend/
    ├── app.py              # Single-file Flask backend — all endpoints
    ├── seed.py             # Seeds demo accounts and H3 location data
    ├── requirements.txt
    └── .env                # GROQ_API_KEY lives here
```

---

## How to Run

### 1. Install dependencies

```bash
cd backend
pip install -r requirements.txt
```

### 2. Seed demo data (first time only)

```bash
python seed.py
```

### 3. Start the backend

```bash
python app.py
```

Backend runs on **http://localhost:8080**

### 4. Open the frontend

Open `frontend/index.html` directly in your browser — no server needed.

---

## Demo Accounts

| Role | Email | Password |
|------|-------|----------|
| Admin | azhar@sdu.edu.kz | admin123 |
| Student | aziz@sdu.edu.kz | student123 |
| Advisor | kamiliya@sdu.edu.kz | advisor123 |
| Student | dana@sdu.edu.kz | student123 |

---

## API Endpoints

### Public / Frontend
| Method | Path | Description |
|--------|------|-------------|
| GET | `/` | Health check |
| GET | `/api/student` | Student profile data |
| POST | `/api/chat` | Socratic AI chat (Groq) |

### Auth
| Method | Path | Description |
|--------|------|-------------|
| POST | `/auth/register` | Register user |
| POST | `/auth/login` | Login, returns token |
| GET | `/auth/me` | Current user info |

### Location (H3)
| Method | Path | Role | Description |
|--------|------|------|-------------|
| POST | `/location/share` | student/admin | GPS → H3 index, fires event |
| GET | `/location/friends` | student/admin | H3 zones of mutual friends (ABAC) |
| GET | `/location/<user_id>` | any (ABAC) | Single user H3 zone |
| POST | `/location/friend-request` | student/admin | Send or accept friend request |

### Moodle
| Method | Path | Role | Description |
|--------|------|------|-------------|
| GET | `/moodle/assignments` | student/admin | Assignments (cached) |
| GET | `/moodle/schedule` | student/admin | Class timetable |

### Analytics & Admin
| Method | Path | Role | Description |
|--------|------|------|-------------|
| GET | `/analytics/heatmap` | admin | H3 zone user counts |
| GET | `/analytics/zone-summary` | admin | Unique users per zone |
| GET | `/admin/users` | admin | List all users |
| GET | `/admin/audit` | admin | Full audit log |
| PUT | `/admin/users/<id>/role` | admin | Change user role |

All protected endpoints require header: `Authorization: <token>`

---

## How H3 Is Used

H3 (Uber's hexagonal geospatial index) is used at **resolution 11** (~25 m cells).

**Flow:**
1. Student sends `POST /location/share { lat, lng }` (opt-in)
2. `h3.latlng_to_cell(lat, lng, res=11)` → compact H3 index string
3. Index stored in `locations.h3_index` column
4. `location_updated` event fires on asyncio.Queue
5. Worker increments `location_stats` for that H3 cell
6. `GET /location/friends` returns H3 zones (not exact GPS) to friends
7. `GET /analytics/heatmap` → `SELECT h3_index, user_count FROM location_stats`

**Why H3:** provides privacy-respecting zone disclosure (zone ≠ exact coordinates), efficient GROUP BY aggregation for the admin heatmap, and natural neighbor queries via `h3.grid_disk()`.

---

## Repository

[github.com/sarsenbayevzz/sdu-ai-agent](https://github.com/sarsenbayevzz/sdu-ai-agent)
